# memobus协议



### 218报头
在使用扩展MEMOBUS协议的通信中，应用数据前将添加12字节的218报头。 218报头的构成及其内容如下
图所示。

![image-20220601085808399](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20220601085808399.png)

### 扩展MEMOBUS指令
由扩展MEMOBUS信息构成的指令通过功能码进行识别，并提供以下功能。

![image-20220601090040721](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20220601090040721.png)

示例报文解析：24字节

1190000000001800000000000c00200d00000200050c060c

解析:

119000000000180000000000  // 218报头  -- 12字节

0c00 //长度（L-H）

20 // MFC 固定20

0d //SFC ,0d--保持寄存器的不连续读取

0000 //CPU编号 自身的cpu编号固定为0

0200  //地址(L-H)

050c //设定寄存器数(L-H)

060c //CRC16



192.168.1.2 -- 192.168.1.1

UDP:10001 --10010

send->24字节

11 1a 00 00 00 00 18 00 00 00 00 00 0c 00 20 0d 00 00 02 00 33 04 34 04        

recv->24字节

19 1a 00 04 00 00 18 00 00 00 00 00 0a 00 20 0d 01 00 02 00 00 00 00 00 

19 1a 00 03 00 00 18 00 00 00 00 00 0a 00 20 0d 01 00 02 00 00 00 00 00 



send-> 22字节 （OD扩展指令 非连续读取 不带crc）

1151000000001600000000000a00200d000001005203

11cb000000001600000000000a00200d000001009209

send->22字节

11cb000000001600000000000a00200d000001009209

解析：

11cb00000000160000000000 //218报文头 12字节

0a00 //长度

20 //MFC 固定20

0d // 0d指令，不连续读取保持寄存器的内容。 (扩展)

0000 //cpu编号?

0100 // 寄存器数量

9209 //寄存器地址

recv->22字节

19 cb 00 01 00 00 16 00 00 00 00 00 08 00 20 0d 01 00 01 00 00 00

解析:

19 cb 00 01 00 00 16 00 00 00 00 00 

08 00 

20 

0d 

01 00 //CPU编号

01 00  //寄存器个数，数量

00 00



send->118字节

11d8000000007600000000006a00200d00003100270b230b220b3d0b3e0b3b0b3c0b5f0a5b0a5a0a750a760a730a740acf08cb08ca08e508e608e308e408970993099209ad09ae09ab09ac090708030802081d081e081b081c08b70cb30cb20ccd0cce0ccb0ccc0cef0beb0bea0b050c060c030c040c

![image-20220601151013079](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20220601151013079.png)

解析：

11d800000000760000000000

6a00

20

0d //SFC

0000

3100

270b

230b

220b

3d0b

3e0b

3b0b

3c0b

5f0a

5b0a

5a0a

750a

760a

730a

740a

cf08

cb08

ca08

e508

e608

e308

e408

9709

9309

9209

ad09

ae09

ab09

ac09

0708

0308

0208

1d08

1e08

1b08

1c08

b70c

b30c

b20c

cd0c

ce0c

cb0c

cc0c

ef0b

eb0b

ea0b

050c

060c

030c

040c

recv->118字节

19d8000700007600000000006800200d010031002100000000000000000000000000200000000000000000000000000021000000000000000000000000002100000000000000000000000000210000000000000000000000000020000000000000000000000000002108000000000000000000000000

19d800070000760000000000

6800

20

0d

0100

3100

2100000000000000000000000000200000000000000000000000000021000000000000000000000000002100000000000000000000000000210000000000000000000000000020000000000000000000000000002108000000000000000000000000
